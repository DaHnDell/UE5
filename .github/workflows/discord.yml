name: Notify Discord on Push

on:
  push:
    branches:
      - main

jobs:
  discord:
    runs-on: ubuntu-latest
    steps:
      - name: Notify Discord
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          AUTHOR_NAME="${{ github.event.head_commit.author.name }}"
          AUTHOR_EMAIL="${{ github.event.head_commit.author.email }}"
          COMMIT_MESSAGE="${{ github.event.head_commit.message }}"
          COMMIT_TIMESTAMP="${{ github.event.head_commit.timestamp }}"
          REPO_URL="https://github.com/${{ github.repository }}"
          AVATAR_URL="https://avatars.githubusercontent.com/${{ github.event.sender.id }}"

          curl -H "Content-Type: application/json" \
            -X POST \
            -d "{
              \"content\": \"ğŸ”” ìƒˆë¡œìš´ ì»¤ë°‹ì´ í‘¸ì‹œë˜ì—ˆìŠµë‹ˆë‹¤!\nğŸ“ ì €ì¥ì†Œ: ${REPO_URL}\nğŸ‘¤ ì‘ì„±ì: ${AVATAR_URL},  ${AUTHOR_NAME}\nğŸ“§ ì´ë©”ì¼: ${AUTHOR_EMAIL}\nğŸ“ ë©”ì‹œì§€: ${COMMIT_MESSAGE}\nâ° ì»¤ë°‹ ì‹œê°„: ${COMMIT_TIMESTAMP}\"
            }" \
            $DISCORD_WEBHOOK
